[0m23:16:26.650717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390932B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390932B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390932B1D0>]}


============================== 23:16:26.666338 | 9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8 ==============================
[0m23:16:26.666338 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:16:26.666338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:27.204532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239093734D0>]}
[0m23:16:27.320522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023908C772C0>]}
[0m23:16:27.320522 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:16:27.690254 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:16:27.690254 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:16:27.690254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023908DD67B0>]}
[0m23:16:29.532947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390A956390>]}
[0m23:16:29.715795 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:16:29.715795 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:16:29.778282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390AAD20F0>]}
[0m23:16:29.778282 [info ] [MainThread]: Found 2 models, 4 data tests, 431 macros
[0m23:16:29.778282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390AA06300>]}
[0m23:16:29.778282 [info ] [MainThread]: 
[0m23:16:29.778282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:29.778282 [info ] [MainThread]: 
[0m23:16:29.789440 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:29.796008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:16:29.922365 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:16:29.922365 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:16:29.922365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:30.202755 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.275 seconds
[0m23:16:30.202755 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:16:30.202755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_public'
[0m23:16:30.218841 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:16:30.218841 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:16:30.218841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:30.271052 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m23:16:30.271052 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:16:30.271052 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:16:30.313006 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m23:16:30.315000 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:16:30.315892 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:16:30.315892 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:30.315892 [debug] [MainThread]: On master: BEGIN
[0m23:16:30.315892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:16:30.378378 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m23:16:30.378378 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:30.378378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:16:30.407513 [debug] [MainThread]: SQL status: SELECT 2 in 0.027 seconds
[0m23:16:30.407513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023906774F20>]}
[0m23:16:30.407513 [debug] [MainThread]: On master: ROLLBACK
[0m23:16:30.407513 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:30.407513 [debug] [MainThread]: On master: BEGIN
[0m23:16:30.407513 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:16:30.407513 [debug] [MainThread]: On master: COMMIT
[0m23:16:30.407513 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:30.407513 [debug] [MainThread]: On master: COMMIT
[0m23:16:30.407513 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:16:30.407513 [debug] [MainThread]: On master: Close
[0m23:16:30.407513 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m23:16:30.407513 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:16:30.423135 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_project.my_first_dbt_model'
[0m23:16:30.423135 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m23:16:30.423135 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m23:16:30.450695 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m23:16:30.500823 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m23:16:30.500823 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:16:30.500823 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m23:16:30.500823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:16:30.563344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m23:16:30.563344 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:16:30.563344 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null


with source_data as (
    select 
        id,
        text,
        youtube_links,
        channel,
        image_path,
        contains_emoji,
        has_youtube_link,
        date
    from public.medical_database -- Use your actual table name
),

cleaned_data as (
    -- Remove emojis from the text field
    select
        id,
        -- Remove non-ASCII characters (emojis) and store cleaned text
        regexp_replace(text, '[^\x00-\x7F]+', '', 'g') as text,
        youtube_links,
        channel,
        image_path,
        -- Check for emojis and store a flag
        case 
            when text ~ '[^\x00-\x7F]' then 'Yes'  -- Contains emojis
            else 'No'  -- Does not contain emojis
        end as contains_emoji,
        -- Check if there's a YouTube link (non-null youtube_links)
        case 
            when youtube_links is not null and youtube_links != '' then 'Yes'
            else 'No'
        end as has_youtube_link,
        date
    from source_data
)

-- Final selection with the transformations
select
    id,
    text,
    youtube_links,
    -- Label for YouTube link status
    case 
        when youtube_links is not null and youtube_links != '' then 'Has Link'
        else 'No Link'
    end as link_status,
    channel,
    image_path,
    contains_emoji,
    has_youtube_link,
    date
from cleaned_data
where id is not null
  );
  
[0m23:16:30.563344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "with"
LINE 40: with source_data as (
         ^

[0m23:16:30.563344 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: ROLLBACK
[0m23:16:30.563344 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m23:16:30.578938 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near "with"
  LINE 40: with source_data as (
           ^
  compiled code at target\run\my_project\models\example\my_first_dbt_model.sql
[0m23:16:30.578938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eccb8f0-3c6e-4d18-8e3d-2a15c30c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002390AA2AF00>]}
[0m23:16:30.578938 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.my_first_dbt_model ................ [[31mERROR[0m in 0.16s]
[0m23:16:30.591945 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m23:16:30.591945 [debug] [Thread-4 (]: Marking all children of 'model.my_project.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near "with"
  LINE 40: with source_data as (
           ^
  compiled code at target\run\my_project\models\example\my_first_dbt_model.sql.
[0m23:16:30.591945 [debug] [Thread-1 (]: Began running node model.my_project.my_second_dbt_model
[0m23:16:30.591945 [info ] [Thread-1 (]: 2 of 2 SKIP relation public.my_second_dbt_model ................................ [[33mSKIP[0m]
[0m23:16:30.591945 [debug] [Thread-1 (]: Finished running node model.my_project.my_second_dbt_model
[0m23:16:30.591945 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:30.591945 [debug] [MainThread]: On master: BEGIN
[0m23:16:30.591945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:16:30.656273 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m23:16:30.656273 [debug] [MainThread]: On master: COMMIT
[0m23:16:30.657269 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:30.657269 [debug] [MainThread]: On master: COMMIT
[0m23:16:30.658270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:16:30.658270 [debug] [MainThread]: On master: Close
[0m23:16:30.659264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:30.660262 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:16:30.660262 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:16:30.661260 [debug] [MainThread]: Connection 'model.my_project.my_first_dbt_model' was properly closed.
[0m23:16:30.661260 [info ] [MainThread]: 
[0m23:16:30.662258 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m23:16:30.663254 [debug] [MainThread]: Command end result
[0m23:16:30.692187 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:16:30.692187 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:16:30.706812 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:16:30.707810 [info ] [MainThread]: 
[0m23:16:30.708808 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:16:30.708808 [info ] [MainThread]: 
[0m23:16:30.709804 [error] [MainThread]:   Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  syntax error at or near "with"
  LINE 40: with source_data as (
           ^
  compiled code at target\run\my_project\models\example\my_first_dbt_model.sql
[0m23:16:30.710802 [info ] [MainThread]: 
[0m23:16:30.711799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:16:30.712823 [debug] [MainThread]: Command `dbt run` failed at 23:16:30.712823 after 4.24 seconds
[0m23:16:30.715930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239030F0FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023909210BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239092421E0>]}
[0m23:16:30.716924 [debug] [MainThread]: Flushing usage events
[0m23:16:31.561742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:59.442076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F47B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F47B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F47B6B0>]}


============================== 23:16:59.448583 | 34dee7c2-e741-4970-b57c-d3535bc7d623 ==============================
[0m23:16:59.448583 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:16:59.448583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:16:59.833857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F510290>]}
[0m23:16:59.945283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F0D47A0>]}
[0m23:16:59.945283 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:17:00.285378 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:17:00.684165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:17:00.684165 [debug] [MainThread]: Partial parsing: updated file: my_project://models\example\my_first_dbt_model.sql
[0m23:17:01.431737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A550D75B50>]}
[0m23:17:01.524917 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:17:01.524917 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:17:01.578312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A551001430>]}
[0m23:17:01.578312 [info ] [MainThread]: Found 2 models, 4 data tests, 431 macros
[0m23:17:01.578312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A550E739B0>]}
[0m23:17:01.578312 [info ] [MainThread]: 
[0m23:17:01.578312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:01.578312 [info ] [MainThread]: 
[0m23:17:01.586618 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:17:01.594141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:17:01.721642 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:17:01.722639 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:17:01.722639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:01.781829 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m23:17:01.781829 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:17:01.781829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_public'
[0m23:17:01.797452 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:17:01.797452 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:17:01.797452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:01.847823 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:17:01.847823 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:17:01.847823 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:17:01.847823 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:17:01.847823 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:17:01.847823 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:17:01.863450 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:01.863450 [debug] [MainThread]: On master: BEGIN
[0m23:17:01.863450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:17:01.924212 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m23:17:01.924212 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:01.925209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:17:01.933945 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m23:17:01.933945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A550D23500>]}
[0m23:17:01.933945 [debug] [MainThread]: On master: ROLLBACK
[0m23:17:01.933945 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:01.933945 [debug] [MainThread]: On master: BEGIN
[0m23:17:01.933945 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:17:01.933945 [debug] [MainThread]: On master: COMMIT
[0m23:17:01.933945 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:01.933945 [debug] [MainThread]: On master: COMMIT
[0m23:17:01.933945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:01.933945 [debug] [MainThread]: On master: Close
[0m23:17:01.933945 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m23:17:01.933945 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:17:01.933945 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_project.my_first_dbt_model'
[0m23:17:01.933945 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m23:17:01.947955 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m23:17:01.947955 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m23:17:02.014162 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m23:17:02.015160 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:17:02.016158 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m23:17:02.017462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:17:02.063639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m23:17:02.063639 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:17:02.063639 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
    select 
        id,
        text,
        youtube_links,
        channel,
        image_path,
        contains_emoji,
        has_youtube_link,
        date
    from public.medical_database -- Use your actual table name
),

cleaned_data as (
    -- Remove emojis from the text field
    select
        id,
        -- Remove non-ASCII characters (emojis) and store cleaned text
        regexp_replace(text, '[^\x00-\x7F]+', '', 'g') as text,
        youtube_links,
        channel,
        image_path,
        -- Check for emojis and store a flag
        case 
            when text ~ '[^\x00-\x7F]' then 'Yes'  -- Contains emojis
            else 'No'  -- Does not contain emojis
        end as contains_emoji,
        -- Check if there's a YouTube link (non-null youtube_links)
        case 
            when youtube_links is not null and youtube_links != '' then 'Yes'
            else 'No'
        end as has_youtube_link,
        date
    from source_data
)

-- Final selection with the transformations
select
    id,
    text,
    youtube_links,
    -- Label for YouTube link status
    case 
        when youtube_links is not null and youtube_links != '' then 'Has Link'
        else 'No Link'
    end as link_status,
    channel,
    image_path,
    contains_emoji,
    has_youtube_link,
    date
from cleaned_data
where id is not null
  );
  
[0m23:17:02.264119 [debug] [Thread-1 (]: SQL status: SELECT 1874 in 0.195 seconds
[0m23:17:02.264119 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:17:02.264119 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:17:02.264119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:17:02.279742 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:17:02.279742 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:17:02.295388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m23:17:02.311011 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:17:02.311011 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:17:02.311011 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:17:02.326605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:17:02.326605 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup"
[0m23:17:02.342261 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:17:02.342261 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:17:02.348768 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m23:17:02.348768 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m23:17:02.364394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54C8226F0>]}
[0m23:17:02.364394 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1874[0m in 0.41s]
[0m23:17:02.364394 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m23:17:02.364394 [debug] [Thread-1 (]: Began running node model.my_project.my_second_dbt_model
[0m23:17:02.364394 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:17:02.364394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_first_dbt_model, now model.my_project.my_second_dbt_model)
[0m23:17:02.364394 [debug] [Thread-1 (]: Began compiling node model.my_project.my_second_dbt_model
[0m23:17:02.364394 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m23:17:02.364394 [debug] [Thread-1 (]: Began executing node model.my_project.my_second_dbt_model
[0m23:17:02.401009 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m23:17:02.401009 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:17:02.401009 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m23:17:02.401009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:02.471187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m23:17:02.472186 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:17:02.472186 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Ethio_Medical_Database"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:17:02.483944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m23:17:02.483944 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:17:02.483944 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:17:02.483944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:17:02.483944 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:17:02.483944 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:17:02.483944 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:17:02.483944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:17:02.499566 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup"
[0m23:17:02.499566 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:17:02.499566 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:17:02.499566 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:17:02.499566 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: Close
[0m23:17:02.499566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34dee7c2-e741-4970-b57c-d3535bc7d623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5514C9AF0>]}
[0m23:17:02.499566 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.14s]
[0m23:17:02.499566 [debug] [Thread-1 (]: Finished running node model.my_project.my_second_dbt_model
[0m23:17:02.499566 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:02.499566 [debug] [MainThread]: On master: BEGIN
[0m23:17:02.499566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:17:02.566603 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m23:17:02.567927 [debug] [MainThread]: On master: COMMIT
[0m23:17:02.568923 [debug] [MainThread]: Using postgres connection "master"
[0m23:17:02.568923 [debug] [MainThread]: On master: COMMIT
[0m23:17:02.569920 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:17:02.569920 [debug] [MainThread]: On master: Close
[0m23:17:02.570920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:02.570920 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:17:02.570920 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:17:02.571915 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m23:17:02.571915 [info ] [MainThread]: 
[0m23:17:02.572912 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m23:17:02.574907 [debug] [MainThread]: Command end result
[0m23:17:02.600976 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:17:02.600976 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:17:02.600976 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:17:02.600976 [info ] [MainThread]: 
[0m23:17:02.600976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:02.616598 [info ] [MainThread]: 
[0m23:17:02.617364 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:17:02.619359 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:02.619359 after 3.35 seconds
[0m23:17:02.620357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A550DBD850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F47B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A54F47B860>]}
[0m23:17:02.620357 [debug] [MainThread]: Flushing usage events
[0m23:17:03.434425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:42.582210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F1D0D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F1D2A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F2EF620>]}


============================== 23:19:42.589190 | bb318e59-60fb-4482-bd8a-67755334aacc ==============================
[0m23:19:42.589190 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:19:42.590187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:19:42.967179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554C693AA0>]}
[0m23:19:43.072897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F580470>]}
[0m23:19:43.074892 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:19:43.416976 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:19:43.642374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:19:43.642374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:19:43.691243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F646240>]}
[0m23:19:43.778011 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:19:43.784992 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:19:43.827878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015550B64B30>]}
[0m23:19:43.828876 [info ] [MainThread]: Found 2 models, 4 data tests, 431 macros
[0m23:19:43.829880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F3089B0>]}
[0m23:19:43.831867 [info ] [MainThread]: 
[0m23:19:43.832864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:19:43.832864 [info ] [MainThread]: 
[0m23:19:43.833861 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:19:43.838854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:19:43.961520 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:19:43.962518 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:19:43.962518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:44.028341 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m23:19:44.030369 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:19:44.032331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_public'
[0m23:19:44.040342 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:19:44.040342 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:19:44.041339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:19:44.095162 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m23:19:44.095162 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:19:44.096160 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:19:44.106133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m23:19:44.108128 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:19:44.108128 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:19:44.115109 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:44.116107 [debug] [MainThread]: On master: BEGIN
[0m23:19:44.116107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:19:44.165973 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m23:19:44.166971 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:44.166971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:19:44.178938 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m23:19:44.180933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001554F4336B0>]}
[0m23:19:44.180933 [debug] [MainThread]: On master: ROLLBACK
[0m23:19:44.181930 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:44.182928 [debug] [MainThread]: On master: BEGIN
[0m23:19:44.182928 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:19:44.183925 [debug] [MainThread]: On master: COMMIT
[0m23:19:44.183925 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:44.183925 [debug] [MainThread]: On master: COMMIT
[0m23:19:44.184922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:44.184922 [debug] [MainThread]: On master: Close
[0m23:19:44.187914 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m23:19:44.188912 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:19:44.189909 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_project.my_first_dbt_model'
[0m23:19:44.189909 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m23:19:44.199882 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m23:19:44.200897 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m23:19:44.261717 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m23:19:44.262715 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:19:44.263713 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m23:19:44.263713 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:19:44.316580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m23:19:44.317568 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:19:44.317568 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
    select 
        id,
        text,
        youtube_links,
        channel,
        image_path,
        contains_emoji,
        has_youtube_link,
        date
    from public.medical_database -- Use your actual table name
),

cleaned_data as (
    -- Remove emojis from the text field
    select
        id,
        -- Remove non-ASCII characters (emojis) and store cleaned text
        regexp_replace(text, '[^\x00-\x7F]+', '', 'g') as text,
        youtube_links,
        channel,
        image_path,
        -- Check for emojis and store a flag
        case 
            when text ~ '[^\x00-\x7F]' then 'Yes'  -- Contains emojis
            else 'No'  -- Does not contain emojis
        end as contains_emoji,
        -- Check if there's a YouTube link (non-null youtube_links)
        case 
            when youtube_links is not null and youtube_links != '' then 'Yes'
            else 'No'
        end as has_youtube_link,
        date
    from source_data
)

-- Final selection with the transformations
select
    id,
    text,
    youtube_links,
    -- Label for YouTube link status
    case 
        when youtube_links is not null and youtube_links != '' then 'Has Link'
        else 'No Link'
    end as link_status,
    channel,
    image_path,
    contains_emoji,
    has_youtube_link,
    date
from cleaned_data
where id is not null
  );
  
[0m23:19:44.411316 [debug] [Thread-1 (]: SQL status: SELECT 1874 in 0.093 seconds
[0m23:19:44.420326 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:19:44.421323 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:19:44.422289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:19:44.426310 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:19:44.426310 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:19:44.428273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:19:44.454235 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:19:44.455232 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:19:44.455232 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:19:44.459189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:19:44.468197 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup"
[0m23:19:44.475180 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:19:44.476176 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:19:44.483124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:19:44.486149 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m23:19:44.490107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015550F805F0>]}
[0m23:19:44.491105 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1874[0m in 0.30s]
[0m23:19:44.492101 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m23:19:44.493131 [debug] [Thread-1 (]: Began running node model.my_project.my_second_dbt_model
[0m23:19:44.494122 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:19:44.495094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_first_dbt_model, now model.my_project.my_second_dbt_model)
[0m23:19:44.495094 [debug] [Thread-1 (]: Began compiling node model.my_project.my_second_dbt_model
[0m23:19:44.499081 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m23:19:44.500079 [debug] [Thread-1 (]: Began executing node model.my_project.my_second_dbt_model
[0m23:19:44.530026 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m23:19:44.531024 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:19:44.532025 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m23:19:44.532025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:19:44.589840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m23:19:44.590837 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:19:44.591838 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Ethio_Medical_Database"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:19:44.597817 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:19:44.601806 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:19:44.602804 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:19:44.603801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:19:44.605796 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:19:44.605796 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:19:44.606793 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:19:44.608790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:19:44.611813 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup"
[0m23:19:44.615802 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:19:44.616801 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:19:44.617766 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:19:44.618795 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: Close
[0m23:19:44.619793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb318e59-60fb-4482-bd8a-67755334aacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015550FCFBC0>]}
[0m23:19:44.620757 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.12s]
[0m23:19:44.621754 [debug] [Thread-1 (]: Finished running node model.my_project.my_second_dbt_model
[0m23:19:44.623748 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:44.624780 [debug] [MainThread]: On master: BEGIN
[0m23:19:44.624780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:19:44.681595 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m23:19:44.681595 [debug] [MainThread]: On master: COMMIT
[0m23:19:44.682591 [debug] [MainThread]: Using postgres connection "master"
[0m23:19:44.682591 [debug] [MainThread]: On master: COMMIT
[0m23:19:44.683589 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:19:44.683589 [debug] [MainThread]: On master: Close
[0m23:19:44.684586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:19:44.684586 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:19:44.685584 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:19:44.685584 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m23:19:44.685584 [info ] [MainThread]: 
[0m23:19:44.686581 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m23:19:44.687578 [debug] [MainThread]: Command end result
[0m23:19:44.717498 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:19:44.721487 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:19:44.731462 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:19:44.732458 [info ] [MainThread]: 
[0m23:19:44.733456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:19:44.733456 [info ] [MainThread]: 
[0m23:19:44.734453 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:19:44.736448 [debug] [MainThread]: Command `dbt run` succeeded at 23:19:44.736448 after 2.64 seconds
[0m23:19:44.737445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015550FDDB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015550FDDAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015550FDC650>]}
[0m23:19:44.737445 [debug] [MainThread]: Flushing usage events
[0m23:19:45.590181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:06.126564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EAEC7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EAEE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EAEE750>]}


============================== 23:21:06.157806 | c0a8af5d-cc70-4c64-ab38-837129f7d257 ==============================
[0m23:21:06.157806 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:21:06.157806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m23:21:06.558019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a8af5d-cc70-4c64-ab38-837129f7d257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741E3ED9D0>]}
[0m23:21:06.657762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0a8af5d-cc70-4c64-ab38-837129f7d257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741F0CB6E0>]}
[0m23:21:06.657762 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:21:06.995968 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:21:07.258778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:21:07.258778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:21:07.312153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0a8af5d-cc70-4c64-ab38-837129f7d257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027420208710>]}
[0m23:21:07.396796 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:21:07.412422 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:21:07.470293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0a8af5d-cc70-4c64-ab38-837129f7d257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027420764D70>]}
[0m23:21:07.470293 [info ] [MainThread]: Found 2 models, 4 data tests, 431 macros
[0m23:21:07.470293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a8af5d-cc70-4c64-ab38-837129f7d257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742038BA70>]}
[0m23:21:07.470293 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:21:07.470293 [debug] [MainThread]: Command end result
[0m23:21:07.512848 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:21:07.512848 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:21:07.512848 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:21:07.512848 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:21:07.512848 after 1.64 seconds
[0m23:21:07.512848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EC3AA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EDA2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741EF77860>]}
[0m23:21:07.512848 [debug] [MainThread]: Flushing usage events
[0m23:21:08.492850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:48.021320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A45AF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A45AF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A45AF920>]}


============================== 23:21:48.021320 | 523e895a-077c-4285-a407-fc20c01cecda ==============================
[0m23:21:48.021320 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:21:48.021320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:21:48.391446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '523e895a-077c-4285-a407-fc20c01cecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A3E2E720>]}
[0m23:21:48.507309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '523e895a-077c-4285-a407-fc20c01cecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A1700110>]}
[0m23:21:48.507309 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:21:48.841197 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:21:49.108242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:21:49.108242 [debug] [MainThread]: Partial parsing: added file: my_project://models\example\raw\sources.yml
[0m23:21:49.386582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '523e895a-077c-4285-a407-fc20c01cecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A58E8710>]}
[0m23:21:49.486823 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:21:49.493329 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:21:49.540198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '523e895a-077c-4285-a407-fc20c01cecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A5EFD6A0>]}
[0m23:21:49.540198 [info ] [MainThread]: Found 2 models, 4 data tests, 1 source, 431 macros
[0m23:21:49.540198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '523e895a-077c-4285-a407-fc20c01cecda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A4614770>]}
[0m23:21:49.540198 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:21:49.540198 [debug] [MainThread]: Command end result
[0m23:21:49.569151 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:21:49.581164 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:21:49.581164 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:21:49.581164 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:21:49.581164 after 1.74 seconds
[0m23:21:49.581164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A5F2BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A471B710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270A59326C0>]}
[0m23:21:49.581164 [debug] [MainThread]: Flushing usage events
[0m23:21:50.426122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:22:34.217110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12E18380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12E1BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12E184D0>]}


============================== 23:22:34.217110 | 73785b05-e668-4a15-9ad6-72eadb69dd54 ==============================
[0m23:22:34.217110 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:22:34.217110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:22:34.595962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73785b05-e668-4a15-9ad6-72eadb69dd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12E67DA0>]}
[0m23:22:34.711825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73785b05-e668-4a15-9ad6-72eadb69dd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12839940>]}
[0m23:22:34.711825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:22:35.050004 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:22:35.297377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:22:35.297377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:22:35.350774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73785b05-e668-4a15-9ad6-72eadb69dd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B14116150>]}
[0m23:22:35.451014 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:22:35.467397 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:22:35.514013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73785b05-e668-4a15-9ad6-72eadb69dd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B1460B620>]}
[0m23:22:35.514013 [info ] [MainThread]: Found 2 models, 4 data tests, 1 source, 431 macros
[0m23:22:35.514013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73785b05-e668-4a15-9ad6-72eadb69dd54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12E1AE10>]}
[0m23:22:35.514013 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:22:35.514013 [debug] [MainThread]: Command end result
[0m23:22:35.551089 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:22:35.551089 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:22:35.567611 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:22:35.570602 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:22:35.570602 after 1.52 seconds
[0m23:22:35.570602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B140EE300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B140EEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B12362D20>]}
[0m23:22:35.571600 [debug] [MainThread]: Flushing usage events
[0m23:22:36.400122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:54.973636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A97AF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A9485FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A97AF8F0>]}


============================== 23:23:54.989257 | 60a1b09c-e50d-421e-a3d8-0a56cf4d3b54 ==============================
[0m23:23:54.989257 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:23:54.989257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:23:55.358628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A99D2330>]}
[0m23:23:55.458609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A991B6E0>]}
[0m23:23:55.458609 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:23:55.790666 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:23:56.013689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:23:56.013689 [debug] [MainThread]: Partial parsing: added file: my_project://snapshots\medical_data_snapshot.sql
[0m23:23:56.542332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AB1916D0>]}
[0m23:23:56.663266 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:23:56.671317 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:23:56.712572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AB14A390>]}
[0m23:23:56.712572 [info ] [MainThread]: Found 2 models, 4 data tests, 1 snapshot, 1 source, 431 macros
[0m23:23:56.712572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AB1919A0>]}
[0m23:23:56.712572 [info ] [MainThread]: 
[0m23:23:56.712572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:23:56.712572 [info ] [MainThread]: 
[0m23:23:56.725927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:23:56.726930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:23:56.850107 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:23:56.850107 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:23:56.850107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:56.943769 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.098 seconds
[0m23:23:56.943769 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:23:56.943769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database, now create_Ethio_Medical_Database_analytics)
[0m23:23:56.943769 [debug] [ThreadPool]: Creating schema "database: "Ethio_Medical_Database"
schema: "analytics"
"
[0m23:23:56.960110 [debug] [ThreadPool]: Using postgres connection "create_Ethio_Medical_Database_analytics"
[0m23:23:56.960110 [debug] [ThreadPool]: On create_Ethio_Medical_Database_analytics: BEGIN
[0m23:23:56.960110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:57.000890 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m23:23:57.000890 [debug] [ThreadPool]: Using postgres connection "create_Ethio_Medical_Database_analytics"
[0m23:23:57.016511 [debug] [ThreadPool]: On create_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_Ethio_Medical_Database_analytics"} */
create schema if not exists "analytics"
[0m23:23:57.016511 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m23:23:57.016511 [debug] [ThreadPool]: On create_Ethio_Medical_Database_analytics: COMMIT
[0m23:23:57.016511 [debug] [ThreadPool]: Using postgres connection "create_Ethio_Medical_Database_analytics"
[0m23:23:57.016511 [debug] [ThreadPool]: On create_Ethio_Medical_Database_analytics: COMMIT
[0m23:23:57.032132 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m23:23:57.032132 [debug] [ThreadPool]: On create_Ethio_Medical_Database_analytics: Close
[0m23:23:57.032132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_analytics'
[0m23:23:57.032132 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:23:57.032132 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:23:57.032132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:23:57.097128 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:23:57.097128 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:23:57.097128 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:23:57.097128 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:23:57.097128 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:23:57.097128 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:23:57.097128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_analytics, now list_Ethio_Medical_Database_public)
[0m23:23:57.112750 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:23:57.112750 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:23:57.112750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:23:57.159613 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m23:23:57.159613 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:23:57.159613 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:23:57.175234 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:23:57.175234 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:23:57.175234 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:23:57.181740 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:57.181740 [debug] [MainThread]: On master: BEGIN
[0m23:23:57.181740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:23:57.244231 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m23:23:57.244231 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:57.244231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:23:57.259850 [debug] [MainThread]: SQL status: SELECT 2 in 0.013 seconds
[0m23:23:57.259850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AAB26F30>]}
[0m23:23:57.259850 [debug] [MainThread]: On master: ROLLBACK
[0m23:23:57.259850 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:57.275472 [debug] [MainThread]: On master: BEGIN
[0m23:23:57.275472 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:23:57.275472 [debug] [MainThread]: On master: COMMIT
[0m23:23:57.275472 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:57.275472 [debug] [MainThread]: On master: COMMIT
[0m23:23:57.275472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:57.275472 [debug] [MainThread]: On master: Close
[0m23:23:57.281979 [debug] [Thread-1 (]: Began running node snapshot.my_project.medical_data_snapshot
[0m23:23:57.281979 [info ] [Thread-1 (]: 1 of 1 START snapshot analytics.medical_data_snapshot .......................... [RUN]
[0m23:23:57.281979 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.my_project.medical_data_snapshot'
[0m23:23:57.281979 [debug] [Thread-1 (]: Began compiling node snapshot.my_project.medical_data_snapshot
[0m23:23:57.281979 [debug] [Thread-1 (]: Began executing node snapshot.my_project.medical_data_snapshot
[0m23:23:57.397672 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:23:57.397672 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "snapshot.my_project.medical_data_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
  id,
  text,
  youtube_links,
  -- Label for YouTube link status
  case 
      when youtube_links is not null and youtube_links != '' then 'Has Link'
      else 'No Link'
  end as link_status,
  channel,
  image_path,
  contains_emoji,
  has_youtube_link,
  date
from "Ethio_Medical_Database"."public"."medical_database"  <!-- Uses the source defined in sources.yml --

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m23:23:57.397672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:23:57.444501 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "<!"
LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                              ^

[0m23:23:57.444501 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: Close
[0m23:23:57.460121 [debug] [Thread-1 (]: Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^
[0m23:23:57.460121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a1b09c-e50d-421e-a3d8-0a56cf4d3b54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AB59CEF0>]}
[0m23:23:57.460121 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting analytics.medical_data_snapshot ...................... [[31mERROR[0m in 0.18s]
[0m23:23:57.460121 [debug] [Thread-1 (]: Finished running node snapshot.my_project.medical_data_snapshot
[0m23:23:57.460121 [debug] [Thread-4 (]: Marking all children of 'snapshot.my_project.medical_data_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^.
[0m23:23:57.475744 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:57.475744 [debug] [MainThread]: On master: BEGIN
[0m23:23:57.475744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:23:57.520215 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m23:23:57.520215 [debug] [MainThread]: On master: COMMIT
[0m23:23:57.520215 [debug] [MainThread]: Using postgres connection "master"
[0m23:23:57.520215 [debug] [MainThread]: On master: COMMIT
[0m23:23:57.520215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:23:57.520215 [debug] [MainThread]: On master: Close
[0m23:23:57.520215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:23:57.520215 [debug] [MainThread]: Connection 'create_Ethio_Medical_Database_analytics' was properly closed.
[0m23:23:57.520215 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:23:57.520215 [debug] [MainThread]: Connection 'snapshot.my_project.medical_data_snapshot' was properly closed.
[0m23:23:57.520215 [info ] [MainThread]: 
[0m23:23:57.535367 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m23:23:57.536365 [debug] [MainThread]: Command end result
[0m23:23:57.564516 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:23:57.568680 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:23:57.574143 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:23:57.574143 [info ] [MainThread]: 
[0m23:23:57.574143 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:23:57.574143 [info ] [MainThread]: 
[0m23:23:57.574143 [error] [MainThread]:   Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^
[0m23:23:57.574143 [info ] [MainThread]: 
[0m23:23:57.582152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:23:57.582152 [debug] [MainThread]: Command `dbt snapshot` failed at 23:23:57.582152 after 2.84 seconds
[0m23:23:57.582152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AB149340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AAD53770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A952EB40>]}
[0m23:23:57.585694 [debug] [MainThread]: Flushing usage events
[0m23:23:59.419216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:24:43.122551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027256AC2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027259310980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027259311910>]}


============================== 23:24:43.122551 | 86fa3f44-7da9-476b-91d7-6e0c50c3a3a0 ==============================
[0m23:24:43.122551 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:24:43.122551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:43.502698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725984FAA0>]}
[0m23:24:43.607943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272599B8D70>]}
[0m23:24:43.607943 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:24:43.949932 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:24:44.224670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:24:44.224670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:24:44.302778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725AC26F60>]}
[0m23:24:44.425233 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:24:44.440828 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:24:44.472070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027259B41A30>]}
[0m23:24:44.472070 [info ] [MainThread]: Found 2 models, 4 data tests, 1 snapshot, 1 source, 431 macros
[0m23:24:44.487691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027259864B30>]}
[0m23:24:44.487691 [info ] [MainThread]: 
[0m23:24:44.487691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:44.493749 [info ] [MainThread]: 
[0m23:24:44.494965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:24:44.496961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:24:44.609782 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:24:44.609782 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:24:44.609782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:44.788222 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.179 seconds
[0m23:24:44.788222 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:24:44.803816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_public'
[0m23:24:44.810323 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:24:44.810323 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:24:44.810323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:44.857192 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:24:44.857192 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:24:44.857192 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:24:44.872817 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:24:44.872817 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:24:44.872817 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:24:44.872817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_public, now list_Ethio_Medical_Database_analytics)
[0m23:24:44.872817 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:24:44.872817 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:24:44.872817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:24:44.941864 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m23:24:44.941864 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:24:44.941864 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:24:44.957457 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m23:24:44.957457 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:24:44.957457 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:24:44.973081 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:44.973081 [debug] [MainThread]: On master: BEGIN
[0m23:24:44.973081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:24:45.026453 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m23:24:45.026453 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:45.026453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:24:45.026453 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m23:24:45.026453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725B152AE0>]}
[0m23:24:45.026453 [debug] [MainThread]: On master: ROLLBACK
[0m23:24:45.042684 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:45.042893 [debug] [MainThread]: On master: BEGIN
[0m23:24:45.042893 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:24:45.042893 [debug] [MainThread]: On master: COMMIT
[0m23:24:45.042893 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:45.042893 [debug] [MainThread]: On master: COMMIT
[0m23:24:45.042893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:24:45.042893 [debug] [MainThread]: On master: Close
[0m23:24:45.042893 [debug] [Thread-1 (]: Began running node snapshot.my_project.medical_data_snapshot
[0m23:24:45.042893 [info ] [Thread-1 (]: 1 of 1 START snapshot analytics.medical_data_snapshot .......................... [RUN]
[0m23:24:45.042893 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.my_project.medical_data_snapshot'
[0m23:24:45.042893 [debug] [Thread-1 (]: Began compiling node snapshot.my_project.medical_data_snapshot
[0m23:24:45.061900 [debug] [Thread-1 (]: Began executing node snapshot.my_project.medical_data_snapshot
[0m23:24:45.153372 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:24:45.153372 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "snapshot.my_project.medical_data_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
  id,
  text,
  youtube_links,
  -- Label for YouTube link status
  case 
      when youtube_links is not null and youtube_links != '' then 'Has Link'
      else 'No Link'
  end as link_status,
  channel,
  image_path,
  contains_emoji,
  has_youtube_link,
  date
from "Ethio_Medical_Database"."public"."medical_database"  <!-- Uses the source defined in sources.yml --

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m23:24:45.153372 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:24:45.211242 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "<!"
LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                              ^

[0m23:24:45.211242 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: Close
[0m23:24:45.211242 [debug] [Thread-1 (]: Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^
[0m23:24:45.226870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86fa3f44-7da9-476b-91d7-6e0c50c3a3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027258D29310>]}
[0m23:24:45.226870 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting analytics.medical_data_snapshot ...................... [[31mERROR[0m in 0.17s]
[0m23:24:45.226870 [debug] [Thread-1 (]: Finished running node snapshot.my_project.medical_data_snapshot
[0m23:24:45.226870 [debug] [Thread-4 (]: Marking all children of 'snapshot.my_project.medical_data_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^.
[0m23:24:45.226870 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:45.226870 [debug] [MainThread]: On master: BEGIN
[0m23:24:45.226870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:24:45.293349 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m23:24:45.293349 [debug] [MainThread]: On master: COMMIT
[0m23:24:45.294347 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:45.294347 [debug] [MainThread]: On master: COMMIT
[0m23:24:45.295344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:24:45.295344 [debug] [MainThread]: On master: Close
[0m23:24:45.296341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:45.296341 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:24:45.296341 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_analytics' was properly closed.
[0m23:24:45.297339 [debug] [MainThread]: Connection 'snapshot.my_project.medical_data_snapshot' was properly closed.
[0m23:24:45.297339 [info ] [MainThread]: 
[0m23:24:45.298336 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m23:24:45.299333 [debug] [MainThread]: Command end result
[0m23:24:45.326975 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:24:45.331695 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:24:45.338662 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:24:45.338662 [info ] [MainThread]: 
[0m23:24:45.338662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:24:45.338662 [info ] [MainThread]: 
[0m23:24:45.338662 [error] [MainThread]:   Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^
[0m23:24:45.338662 [info ] [MainThread]: 
[0m23:24:45.338662 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:24:45.349343 [debug] [MainThread]: Command `dbt snapshot` failed at 23:24:45.349343 after 2.39 seconds
[0m23:24:45.350341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027259310980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272591DAA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027256AC2D80>]}
[0m23:24:45.350341 [debug] [MainThread]: Flushing usage events
[0m23:24:46.168705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:08.361571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680C8F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680C8F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680C8FB60>]}


============================== 23:26:08.361571 | a285fedd-1db5-43da-98fe-5c5961bd3892 ==============================
[0m23:26:08.361571 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:26:08.361571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:08.745873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680CCC920>]}
[0m23:26:08.850202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680CF7170>]}
[0m23:26:08.850202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:26:09.193517 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:26:09.431832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:09.431832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:09.509971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C681FEA360>]}
[0m23:26:09.632185 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:26:09.632185 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:26:09.679073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68254EFF0>]}
[0m23:26:09.679073 [info ] [MainThread]: Found 2 models, 4 data tests, 1 snapshot, 1 source, 431 macros
[0m23:26:09.679073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68253ED50>]}
[0m23:26:09.679073 [info ] [MainThread]: 
[0m23:26:09.679073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:26:09.679073 [info ] [MainThread]: 
[0m23:26:09.696222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:26:09.697459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:26:09.807911 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:26:09.807911 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:26:09.807911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:09.925806 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.107 seconds
[0m23:26:09.925806 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:26:09.932345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_public'
[0m23:26:09.932345 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:26:09.932345 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:26:09.932345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:26:09.994835 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:26:09.994835 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:26:09.994835 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:26:09.994835 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m23:26:09.994835 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:26:09.994835 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:26:09.994835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_public, now list_Ethio_Medical_Database_analytics)
[0m23:26:10.010456 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:26:10.010456 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:26:10.010456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:26:10.048210 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m23:26:10.063831 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:26:10.063831 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:26:10.063831 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m23:26:10.063831 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:26:10.063831 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:26:10.079453 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:10.079453 [debug] [MainThread]: On master: BEGIN
[0m23:26:10.079453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:26:10.133156 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m23:26:10.133156 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:10.134154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:26:10.140792 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m23:26:10.140792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6825455E0>]}
[0m23:26:10.140792 [debug] [MainThread]: On master: ROLLBACK
[0m23:26:10.140792 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:10.140792 [debug] [MainThread]: On master: BEGIN
[0m23:26:10.140792 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:26:10.140792 [debug] [MainThread]: On master: COMMIT
[0m23:26:10.140792 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:10.140792 [debug] [MainThread]: On master: COMMIT
[0m23:26:10.140792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:10.140792 [debug] [MainThread]: On master: Close
[0m23:26:10.140792 [debug] [Thread-1 (]: Began running node snapshot.my_project.medical_data_snapshot
[0m23:26:10.140792 [info ] [Thread-1 (]: 1 of 1 START snapshot analytics.medical_data_snapshot .......................... [RUN]
[0m23:26:10.140792 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.my_project.medical_data_snapshot'
[0m23:26:10.140792 [debug] [Thread-1 (]: Began compiling node snapshot.my_project.medical_data_snapshot
[0m23:26:10.156415 [debug] [Thread-1 (]: Began executing node snapshot.my_project.medical_data_snapshot
[0m23:26:10.273631 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:26:10.273631 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "snapshot.my_project.medical_data_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
  id,
  text,
  youtube_links,
  -- Label for YouTube link status
  case 
      when youtube_links is not null and youtube_links != '' then 'Has Link'
      else 'No Link'
  end as link_status,
  channel,
  image_path,
  contains_emoji,
  has_youtube_link,
  date
from "Ethio_Medical_Database"."public"."medical_database"  <!-- Uses the source defined in sources.yml --

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m23:26:10.273631 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:26:10.320494 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "<!"
LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                              ^

[0m23:26:10.320494 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: Close
[0m23:26:10.333502 [debug] [Thread-1 (]: Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^
[0m23:26:10.333502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a285fedd-1db5-43da-98fe-5c5961bd3892', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680D70200>]}
[0m23:26:10.333502 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting analytics.medical_data_snapshot ...................... [[31mERROR[0m in 0.19s]
[0m23:26:10.333502 [debug] [Thread-1 (]: Finished running node snapshot.my_project.medical_data_snapshot
[0m23:26:10.333502 [debug] [Thread-4 (]: Marking all children of 'snapshot.my_project.medical_data_snapshot' to be skipped because of status 'error'.  Reason: Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^.
[0m23:26:10.333502 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:10.333502 [debug] [MainThread]: On master: BEGIN
[0m23:26:10.333502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:26:10.403079 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m23:26:10.404076 [debug] [MainThread]: On master: COMMIT
[0m23:26:10.404076 [debug] [MainThread]: Using postgres connection "master"
[0m23:26:10.405073 [debug] [MainThread]: On master: COMMIT
[0m23:26:10.405073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:26:10.406070 [debug] [MainThread]: On master: Close
[0m23:26:10.406070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:26:10.407068 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:26:10.407068 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_analytics' was properly closed.
[0m23:26:10.408067 [debug] [MainThread]: Connection 'snapshot.my_project.medical_data_snapshot' was properly closed.
[0m23:26:10.408067 [info ] [MainThread]: 
[0m23:26:10.409084 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m23:26:10.409084 [debug] [MainThread]: Command end result
[0m23:26:10.438352 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:26:10.443904 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:26:10.447622 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:26:10.447622 [info ] [MainThread]: 
[0m23:26:10.447622 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:26:10.447622 [info ] [MainThread]: 
[0m23:26:10.447622 [error] [MainThread]:   Database Error in snapshot medical_data_snapshot (snapshots\medical_data_snapshot.sql)
  syntax error at or near "<!"
  LINE 35: ...io_Medical_Database"."public"."medical_database"  <!-- Uses ...
                                                                ^
[0m23:26:10.447622 [info ] [MainThread]: 
[0m23:26:10.458452 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:26:10.461743 [debug] [MainThread]: Command `dbt snapshot` failed at 23:26:10.461743 after 2.33 seconds
[0m23:26:10.461743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C68011E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680C8F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C680C8FBC0>]}
[0m23:26:10.462741 [debug] [MainThread]: Flushing usage events
[0m23:26:11.429274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:56.937210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5AA9E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B5255E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B06F9E0>]}


============================== 23:27:56.937210 | e81320f3-64db-4d1b-94fc-1ac0f1eae69f ==============================
[0m23:27:56.937210 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:27:56.937210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:27:57.322079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B6773E0>]}
[0m23:27:57.422323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B628470>]}
[0m23:27:57.422323 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:27:57.775617 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:27:58.091992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:27:58.091992 [debug] [MainThread]: Partial parsing: updated file: my_project://snapshots\medical_data_snapshot.sql
[0m23:27:58.570324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5D0007D0>]}
[0m23:27:58.692568 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:27:58.702828 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:27:58.736543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5CF99370>]}
[0m23:27:58.736543 [info ] [MainThread]: Found 2 models, 4 data tests, 1 snapshot, 1 source, 431 macros
[0m23:27:58.736543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5CE53D70>]}
[0m23:27:58.752138 [info ] [MainThread]: 
[0m23:27:58.752138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:58.752138 [info ] [MainThread]: 
[0m23:27:58.754691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:58.756948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:27:58.871375 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:27:58.871375 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:27:58.871375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:58.936878 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.061 seconds
[0m23:27:58.936878 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:27:58.936878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_analytics'
[0m23:27:58.952474 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:27:58.952474 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:27:58.952474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:59.008854 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:27:59.008854 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:27:59.008854 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:27:59.008854 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.009 seconds
[0m23:27:59.021360 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:27:59.021360 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:27:59.021360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_analytics, now list_Ethio_Medical_Database_public)
[0m23:27:59.021360 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:27:59.021360 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:27:59.021360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:27:59.068229 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m23:27:59.068229 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:27:59.068229 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:27:59.083851 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m23:27:59.083851 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:27:59.083851 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:27:59.083851 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:59.083851 [debug] [MainThread]: On master: BEGIN
[0m23:27:59.083851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:59.137227 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m23:27:59.137227 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:59.137227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:27:59.152848 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m23:27:59.152848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B86BA70>]}
[0m23:27:59.152848 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:59.152848 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:59.152848 [debug] [MainThread]: On master: BEGIN
[0m23:27:59.152848 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:27:59.152848 [debug] [MainThread]: On master: COMMIT
[0m23:27:59.152848 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:59.152848 [debug] [MainThread]: On master: COMMIT
[0m23:27:59.152848 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:27:59.152848 [debug] [MainThread]: On master: Close
[0m23:27:59.152848 [debug] [Thread-1 (]: Began running node snapshot.my_project.medical_data_snapshot
[0m23:27:59.168469 [info ] [Thread-1 (]: 1 of 1 START snapshot analytics.medical_data_snapshot .......................... [RUN]
[0m23:27:59.168469 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.my_project.medical_data_snapshot'
[0m23:27:59.168469 [debug] [Thread-1 (]: Began compiling node snapshot.my_project.medical_data_snapshot
[0m23:27:59.168469 [debug] [Thread-1 (]: Began executing node snapshot.my_project.medical_data_snapshot
[0m23:27:59.284419 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:27:59.284419 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "snapshot.my_project.medical_data_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
  id,
  text,
  youtube_links,
  -- Label for YouTube link status
  case 
      when youtube_links is not null and youtube_links != '' then 'Has Link'
      else 'No Link'
  end as link_status,
  channel,
  image_path,
  contains_emoji,
  has_youtube_link,
  date
from "Ethio_Medical_Database"."public"."medical_database"  -- Uses the source defined in sources.yml

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m23:27:59.284419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:27:59.409315 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.124 seconds
[0m23:27:59.409315 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:27:59.409315 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "snapshot.my_project.medical_data_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m23:27:59.409315 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m23:27:59.409315 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.my_project.medical_data_snapshot"
[0m23:27:59.437947 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:27:59.437947 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: BEGIN
[0m23:27:59.437947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m23:27:59.437947 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:27:59.437947 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "snapshot.my_project.medical_data_snapshot"} */

      
  
    

  create  table "Ethio_Medical_Database"."analytics"."medical_data_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
from (
        



select
  id,
  text,
  youtube_links,
  -- Label for YouTube link status
  case 
      when youtube_links is not null and youtube_links != '' then 'Has Link'
      else 'No Link'
  end as link_status,
  channel,
  image_path,
  contains_emoji,
  has_youtube_link,
  date
from "Ethio_Medical_Database"."public"."medical_database"  -- Uses the source defined in sources.yml

    ) sbq



  );
  
  
[0m23:27:59.622848 [debug] [Thread-1 (]: SQL status: SELECT 1874 in 0.188 seconds
[0m23:27:59.654095 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: COMMIT
[0m23:27:59.654095 [debug] [Thread-1 (]: Using postgres connection "snapshot.my_project.medical_data_snapshot"
[0m23:27:59.654095 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: COMMIT
[0m23:27:59.654095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m23:27:59.654095 [debug] [Thread-1 (]: On snapshot.my_project.medical_data_snapshot: Close
[0m23:27:59.654095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81320f3-64db-4d1b-94fc-1ac0f1eae69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D589B2B70>]}
[0m23:27:59.654095 [info ] [Thread-1 (]: 1 of 1 OK snapshotted analytics.medical_data_snapshot .......................... [[32mSELECT 1874[0m in 0.49s]
[0m23:27:59.669716 [debug] [Thread-1 (]: Finished running node snapshot.my_project.medical_data_snapshot
[0m23:27:59.669716 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:59.669716 [debug] [MainThread]: On master: BEGIN
[0m23:27:59.669716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:59.726385 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m23:27:59.726385 [debug] [MainThread]: On master: COMMIT
[0m23:27:59.727383 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:59.727383 [debug] [MainThread]: On master: COMMIT
[0m23:27:59.728379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:27:59.729211 [debug] [MainThread]: On master: Close
[0m23:27:59.729211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:59.730209 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:27:59.730209 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:27:59.731207 [debug] [MainThread]: Connection 'snapshot.my_project.medical_data_snapshot' was properly closed.
[0m23:27:59.731207 [info ] [MainThread]: 
[0m23:27:59.732219 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m23:27:59.733201 [debug] [MainThread]: Command end result
[0m23:27:59.751066 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:27:59.764046 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:27:59.764046 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:27:59.764046 [info ] [MainThread]: 
[0m23:27:59.764046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:59.764046 [info ] [MainThread]: 
[0m23:27:59.764046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:27:59.780112 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:27:59.779109 after 3.14 seconds
[0m23:27:59.780112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5CDD3A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B6A0B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5B09BE00>]}
[0m23:27:59.781105 [debug] [MainThread]: Flushing usage events
[0m23:28:00.672276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:18.543308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2FEEB2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E281A05040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E281704560>]}


============================== 23:29:18.558929 | 10419992-1e38-445c-9606-27ff7331074e ==============================
[0m23:29:18.558929 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:29:18.558929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:29:18.927987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E281CC77A0>]}
[0m23:29:19.043802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28151B6B0>]}
[0m23:29:19.043802 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:29:19.381718 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:29:19.660313 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m23:29:19.660313 [debug] [MainThread]: Partial parsing: added file: my_project://models\raw\sources.yml
[0m23:29:19.660313 [debug] [MainThread]: Partial parsing: added file: my_project://models\my_model.sql
[0m23:29:20.606778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2837D9C40>]}
[0m23:29:20.722611 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:29:20.738267 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:29:20.785097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2839ED490>]}
[0m23:29:20.785097 [info ] [MainThread]: Found 3 models, 4 data tests, 1 snapshot, 1 source, 431 macros
[0m23:29:20.785097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28393B350>]}
[0m23:29:20.791603 [info ] [MainThread]: 
[0m23:29:20.791603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:20.791603 [info ] [MainThread]: 
[0m23:29:20.791603 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:29:20.791603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:29:20.923437 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:29:20.924438 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:29:20.924438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:20.979325 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.062 seconds
[0m23:29:20.979325 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:29:20.979325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_analytics'
[0m23:29:20.991833 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:29:20.991833 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:29:20.991833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:21.038702 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:29:21.038702 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:29:21.038702 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:29:21.054323 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m23:29:21.054323 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:29:21.054323 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:29:21.054323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_analytics, now list_Ethio_Medical_Database_public)
[0m23:29:21.054323 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:29:21.054323 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:29:21.054323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:21.107698 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m23:29:21.107698 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:29:21.107698 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:29:21.123319 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m23:29:21.123319 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:29:21.123319 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:29:21.123319 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:21.123319 [debug] [MainThread]: On master: BEGIN
[0m23:29:21.123319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:29:21.185804 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m23:29:21.185804 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:21.185804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:29:21.192311 [debug] [MainThread]: SQL status: SELECT 2 in 0.010 seconds
[0m23:29:21.192311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E281DA3560>]}
[0m23:29:21.192311 [debug] [MainThread]: On master: ROLLBACK
[0m23:29:21.192311 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:21.192311 [debug] [MainThread]: On master: BEGIN
[0m23:29:21.192311 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:29:21.192311 [debug] [MainThread]: On master: COMMIT
[0m23:29:21.192311 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:21.192311 [debug] [MainThread]: On master: COMMIT
[0m23:29:21.207938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:21.207938 [debug] [MainThread]: On master: Close
[0m23:29:21.207938 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m23:29:21.207938 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:29:21.207938 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_project.my_first_dbt_model'
[0m23:29:21.207938 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m23:29:21.223560 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m23:29:21.226612 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m23:29:21.283421 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m23:29:21.283421 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:29:21.283421 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m23:29:21.283421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:29:21.323675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m23:29:21.323675 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:29:21.323675 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
    select 
        id,
        text,
        youtube_links,
        channel,
        image_path,
        contains_emoji,
        has_youtube_link,
        date
    from public.medical_database -- Use your actual table name
),

cleaned_data as (
    -- Remove emojis from the text field
    select
        id,
        -- Remove non-ASCII characters (emojis) and store cleaned text
        regexp_replace(text, '[^\x00-\x7F]+', '', 'g') as text,
        youtube_links,
        channel,
        image_path,
        -- Check for emojis and store a flag
        case 
            when text ~ '[^\x00-\x7F]' then 'Yes'  -- Contains emojis
            else 'No'  -- Does not contain emojis
        end as contains_emoji,
        -- Check if there's a YouTube link (non-null youtube_links)
        case 
            when youtube_links is not null and youtube_links != '' then 'Yes'
            else 'No'
        end as has_youtube_link,
        date
    from source_data
)

-- Final selection with the transformations
select
    id,
    text,
    youtube_links,
    -- Label for YouTube link status
    case 
        when youtube_links is not null and youtube_links != '' then 'Has Link'
        else 'No Link'
    end as link_status,
    channel,
    image_path,
    contains_emoji,
    has_youtube_link,
    date
from cleaned_data
where id is not null
  );
  
[0m23:29:21.408292 [debug] [Thread-1 (]: SQL status: SELECT 1874 in 0.077 seconds
[0m23:29:21.424655 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:29:21.424655 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:29:21.424655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:29:21.424655 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:29:21.434578 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:29:21.436574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:21.449237 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:29:21.449237 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:29:21.449237 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:29:21.464860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:29:21.570625 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup"
[0m23:29:21.570625 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:29:21.570625 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:29:21.592751 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m23:29:21.592751 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m23:29:21.592751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E281138D40>]}
[0m23:29:21.608377 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1874[0m in 0.38s]
[0m23:29:21.608377 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m23:29:21.608377 [debug] [Thread-1 (]: Began running node model.my_project.my_model
[0m23:29:21.608377 [info ] [Thread-1 (]: 2 of 3 START sql view model public.my_model .................................... [RUN]
[0m23:29:21.608377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_first_dbt_model, now model.my_project.my_model)
[0m23:29:21.608377 [debug] [Thread-1 (]: Began compiling node model.my_project.my_model
[0m23:29:23.475086 [debug] [Thread-1 (]: Compilation Error in model my_model (models\my_model.sql)
  'get_current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:29:23.475086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E283823C20>]}
[0m23:29:23.475086 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.my_model ........................... [[31mERROR[0m in 1.87s]
[0m23:29:23.490739 [debug] [Thread-1 (]: Finished running node model.my_project.my_model
[0m23:29:23.490739 [debug] [Thread-1 (]: Began running node model.my_project.my_second_dbt_model
[0m23:29:23.490739 [debug] [Thread-4 (]: Marking all children of 'model.my_project.my_model' to be skipped because of status 'error'.  Reason: Compilation Error in model my_model (models\my_model.sql)
  'get_current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m23:29:23.490739 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:29:23.490739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_model, now model.my_project.my_second_dbt_model)
[0m23:29:23.490739 [debug] [Thread-1 (]: Began compiling node model.my_project.my_second_dbt_model
[0m23:29:23.497276 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m23:29:23.497276 [debug] [Thread-1 (]: Began executing node model.my_project.my_second_dbt_model
[0m23:29:23.526031 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m23:29:23.526031 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:29:23.526031 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m23:29:23.526031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:23.586719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m23:29:23.587717 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:29:23.588718 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Ethio_Medical_Database"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:29:23.598654 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m23:29:23.602453 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:29:23.603450 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:29:23.604420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:29:23.606442 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:29:23.607450 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:29:23.607450 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:29:23.609408 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:29:23.612431 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup"
[0m23:29:23.617433 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:29:23.617433 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:29:23.617433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:29:23.617433 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: Close
[0m23:29:23.617433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10419992-1e38-445c-9606-27ff7331074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28371BEC0>]}
[0m23:29:23.617433 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m23:29:23.617433 [debug] [Thread-1 (]: Finished running node model.my_project.my_second_dbt_model
[0m23:29:23.617433 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:23.617433 [debug] [MainThread]: On master: BEGIN
[0m23:29:23.617433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:29:23.683760 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m23:29:23.684757 [debug] [MainThread]: On master: COMMIT
[0m23:29:23.684757 [debug] [MainThread]: Using postgres connection "master"
[0m23:29:23.685754 [debug] [MainThread]: On master: COMMIT
[0m23:29:23.685754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:29:23.686751 [debug] [MainThread]: On master: Close
[0m23:29:23.686751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:23.687748 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:29:23.687748 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:29:23.688746 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m23:29:23.688746 [info ] [MainThread]: 
[0m23:29:23.689743 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m23:29:23.690742 [debug] [MainThread]: Command end result
[0m23:29:23.717326 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:29:23.717326 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:29:23.735628 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:29:23.735628 [info ] [MainThread]: 
[0m23:29:23.736626 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:29:23.737656 [info ] [MainThread]: 
[0m23:29:23.738653 [error] [MainThread]:   Compilation Error in model my_model (models\my_model.sql)
  'get_current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:29:23.739617 [info ] [MainThread]: 
[0m23:29:23.740618 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:29:23.742642 [debug] [MainThread]: Command `dbt run` failed at 23:29:23.741644 after 5.37 seconds
[0m23:29:23.742642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2FEEB2D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E281966F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2819642C0>]}
[0m23:29:23.743642 [debug] [MainThread]: Flushing usage events
[0m23:29:24.617152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:39.746992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164FE3F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164FE3F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164FE3FAA0>]}


============================== 23:30:39.746992 | 4b620a2e-5aa5-40ea-944f-cee8eb260c6e ==============================
[0m23:30:39.746992 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:30:39.746992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:30:40.132198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164F655580>]}
[0m23:30:40.248084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164FF1C320>]}
[0m23:30:40.248084 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:30:40.591945 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:30:40.864743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:30:40.864743 [debug] [MainThread]: Partial parsing: added file: my_project://macros\my_macros.sql
[0m23:30:40.996229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216501F8FE0>]}
[0m23:30:41.127901 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:30:41.135881 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:30:41.169160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021650246690>]}
[0m23:30:41.169160 [info ] [MainThread]: Found 3 models, 4 data tests, 1 snapshot, 1 source, 432 macros
[0m23:30:41.169160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164DB24350>]}
[0m23:30:41.184782 [info ] [MainThread]: 
[0m23:30:41.184782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:30:41.184782 [info ] [MainThread]: 
[0m23:30:41.184782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:30:41.184782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database'
[0m23:30:41.319665 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database"
[0m23:30:41.319665 [debug] [ThreadPool]: On list_Ethio_Medical_Database: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database"} */

    select distinct nspname from pg_namespace
  
[0m23:30:41.319665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:41.382183 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.069 seconds
[0m23:30:41.382183 [debug] [ThreadPool]: On list_Ethio_Medical_Database: Close
[0m23:30:41.397773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_analytics'
[0m23:30:41.403281 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:30:41.403281 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:30:41.403281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:41.450150 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:30:41.450150 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:30:41.450150 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:30:41.465771 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.008 seconds
[0m23:30:41.465771 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:30:41.465771 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:30:41.465771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_analytics, now list_Ethio_Medical_Database_public)
[0m23:30:41.465771 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:30:41.465771 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:30:41.465771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:30:41.519146 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m23:30:41.519146 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:30:41.519146 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:30:41.519146 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m23:30:41.534768 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:30:41.534768 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:30:41.534768 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:41.534768 [debug] [MainThread]: On master: BEGIN
[0m23:30:41.534768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:30:41.581632 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m23:30:41.581632 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:41.581632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:30:41.603760 [debug] [MainThread]: SQL status: SELECT 2 in 0.011 seconds
[0m23:30:41.603760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216501E9A60>]}
[0m23:30:41.603760 [debug] [MainThread]: On master: ROLLBACK
[0m23:30:41.603760 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:41.603760 [debug] [MainThread]: On master: BEGIN
[0m23:30:41.603760 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:30:41.603760 [debug] [MainThread]: On master: COMMIT
[0m23:30:41.603760 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:41.603760 [debug] [MainThread]: On master: COMMIT
[0m23:30:41.603760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:30:41.603760 [debug] [MainThread]: On master: Close
[0m23:30:41.603760 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m23:30:41.603760 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m23:30:41.603760 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_project.my_first_dbt_model'
[0m23:30:41.603760 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m23:30:41.619387 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m23:30:41.619387 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m23:30:41.669141 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m23:30:41.684762 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:30:41.686309 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m23:30:41.686309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:30:41.737488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m23:30:41.737488 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:30:41.737488 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
    select 
        id,
        text,
        youtube_links,
        channel,
        image_path,
        contains_emoji,
        has_youtube_link,
        date
    from public.medical_database -- Use your actual table name
),

cleaned_data as (
    -- Remove emojis from the text field
    select
        id,
        -- Remove non-ASCII characters (emojis) and store cleaned text
        regexp_replace(text, '[^\x00-\x7F]+', '', 'g') as text,
        youtube_links,
        channel,
        image_path,
        -- Check for emojis and store a flag
        case 
            when text ~ '[^\x00-\x7F]' then 'Yes'  -- Contains emojis
            else 'No'  -- Does not contain emojis
        end as contains_emoji,
        -- Check if there's a YouTube link (non-null youtube_links)
        case 
            when youtube_links is not null and youtube_links != '' then 'Yes'
            else 'No'
        end as has_youtube_link,
        date
    from source_data
)

-- Final selection with the transformations
select
    id,
    text,
    youtube_links,
    -- Label for YouTube link status
    case 
        when youtube_links is not null and youtube_links != '' then 'Has Link'
        else 'No Link'
    end as link_status,
    channel,
    image_path,
    contains_emoji,
    has_youtube_link,
    date
from cleaned_data
where id is not null
  );
  
[0m23:30:41.799975 [debug] [Thread-1 (]: SQL status: SELECT 1874 in 0.060 seconds
[0m23:30:41.803517 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:30:41.803517 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m23:30:41.803517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:30:41.803517 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:30:41.803517 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m23:30:41.803517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:30:41.834765 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:30:41.834765 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:30:41.834765 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m23:30:41.834765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:30:41.850412 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup"
[0m23:30:41.850412 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m23:30:41.850412 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "Ethio_Medical_Database"."public"."my_first_dbt_model__dbt_backup" cascade
[0m23:30:41.866007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m23:30:41.866007 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m23:30:41.866007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164D1E29C0>]}
[0m23:30:41.866007 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1874[0m in 0.26s]
[0m23:30:41.866007 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m23:30:41.881628 [debug] [Thread-1 (]: Began running node model.my_project.my_model
[0m23:30:41.881628 [info ] [Thread-1 (]: 2 of 3 START sql view model public.my_model .................................... [RUN]
[0m23:30:41.881628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_first_dbt_model, now model.my_project.my_model)
[0m23:30:41.881628 [debug] [Thread-1 (]: Began compiling node model.my_project.my_model
[0m23:30:41.881628 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_model"
[0m23:30:41.881628 [debug] [Thread-1 (]: Began executing node model.my_project.my_model
[0m23:30:41.903586 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_model"
[0m23:30:41.938897 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_model"
[0m23:30:41.939895 [debug] [Thread-1 (]: On model.my_project.my_model: BEGIN
[0m23:30:41.939895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:41.993067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m23:30:41.994065 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_model"
[0m23:30:41.994065 [debug] [Thread-1 (]: On model.my_project.my_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_model"} */

  create view "Ethio_Medical_Database"."public"."my_model__dbt_tmp"
    
    
  as (
    select
  id,
  text,
  
  current_date
 as current_date
from
  "Ethio_Medical_Database"."public"."medical_database"
  );
[0m23:30:42.000048 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m23:30:42.004064 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_model"
[0m23:30:42.004064 [debug] [Thread-1 (]: On model.my_project.my_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_model"} */
alter table "Ethio_Medical_Database"."public"."my_model" rename to "my_model__dbt_backup"
[0m23:30:42.004064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:30:42.004064 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_model"
[0m23:30:42.004064 [debug] [Thread-1 (]: On model.my_project.my_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_model"} */
alter table "Ethio_Medical_Database"."public"."my_model__dbt_tmp" rename to "my_model"
[0m23:30:42.004064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:30:42.004064 [debug] [Thread-1 (]: On model.my_project.my_model: COMMIT
[0m23:30:42.004064 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_model"
[0m23:30:42.004064 [debug] [Thread-1 (]: On model.my_project.my_model: COMMIT
[0m23:30:42.004064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:30:42.004064 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_model__dbt_backup"
[0m23:30:42.019689 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_model"
[0m23:30:42.019689 [debug] [Thread-1 (]: On model.my_project.my_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_model"} */
drop view if exists "Ethio_Medical_Database"."public"."my_model__dbt_backup" cascade
[0m23:30:42.019689 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m23:30:42.019689 [debug] [Thread-1 (]: On model.my_project.my_model: Close
[0m23:30:42.019689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021651B205F0>]}
[0m23:30:42.019689 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.my_model ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m23:30:42.019689 [debug] [Thread-1 (]: Finished running node model.my_project.my_model
[0m23:30:42.019689 [debug] [Thread-1 (]: Began running node model.my_project.my_second_dbt_model
[0m23:30:42.019689 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m23:30:42.019689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_model, now model.my_project.my_second_dbt_model)
[0m23:30:42.019689 [debug] [Thread-1 (]: Began compiling node model.my_project.my_second_dbt_model
[0m23:30:42.036567 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m23:30:42.038330 [debug] [Thread-1 (]: Began executing node model.my_project.my_second_dbt_model
[0m23:30:42.042424 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m23:30:42.042424 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:30:42.042424 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m23:30:42.042424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:30:42.103798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m23:30:42.103798 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:30:42.104795 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "Ethio_Medical_Database"."public"."my_first_dbt_model"
where id = 1
  );
[0m23:30:42.111777 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:30:42.115766 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:30:42.116763 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m23:30:42.117760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:30:42.119468 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:30:42.120466 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:30:42.120466 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m23:30:42.122460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:30:42.125452 [debug] [Thread-1 (]: Applying DROP to: "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup"
[0m23:30:42.126449 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m23:30:42.126449 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "Ethio_Medical_Database"."public"."my_second_dbt_model__dbt_backup" cascade
[0m23:30:42.127447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:30:42.129442 [debug] [Thread-1 (]: On model.my_project.my_second_dbt_model: Close
[0m23:30:42.130440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b620a2e-5aa5-40ea-944f-cee8eb260c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021651A7EFF0>]}
[0m23:30:42.131438 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m23:30:42.132435 [debug] [Thread-1 (]: Finished running node model.my_project.my_second_dbt_model
[0m23:30:42.133440 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:42.134429 [debug] [MainThread]: On master: BEGIN
[0m23:30:42.134429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:30:42.187858 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m23:30:42.188855 [debug] [MainThread]: On master: COMMIT
[0m23:30:42.188855 [debug] [MainThread]: Using postgres connection "master"
[0m23:30:42.189851 [debug] [MainThread]: On master: COMMIT
[0m23:30:42.189851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:30:42.190849 [debug] [MainThread]: On master: Close
[0m23:30:42.190849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:42.191846 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database' was properly closed.
[0m23:30:42.191846 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:30:42.191846 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m23:30:42.192843 [info ] [MainThread]: 
[0m23:30:42.193847 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m23:30:42.194838 [debug] [MainThread]: Command end result
[0m23:30:42.226087 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:30:42.226087 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:30:42.237714 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:30:42.237714 [info ] [MainThread]: 
[0m23:30:42.237714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:30:42.237714 [info ] [MainThread]: 
[0m23:30:42.237714 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:30:42.237714 [debug] [MainThread]: Command `dbt run` succeeded at 23:30:42.237714 after 2.69 seconds
[0m23:30:42.237714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164D1E29C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164FFA8FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216513FA180>]}
[0m23:30:42.237714 [debug] [MainThread]: Flushing usage events
[0m23:30:43.153783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:13.241726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020723352F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020725F9A4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072611AC30>]}


============================== 23:32:13.241726 | 14db6641-00b8-4f75-8749-ad9aeb6a5e8d ==============================
[0m23:32:13.241726 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:32:13.241726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\DS+ML\\AIM3\\Week-7\\Week-7.Ethiopian-medical-business-Data-Warehouse\\my_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ethio\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:32:13.627396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14db6641-00b8-4f75-8749-ad9aeb6a5e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072611BDA0>]}
[0m23:32:13.727637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14db6641-00b8-4f75-8749-ad9aeb6a5e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020723483DA0>]}
[0m23:32:13.727637 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:32:14.079890 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:32:14.341102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:14.341102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:14.413918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14db6641-00b8-4f75-8749-ad9aeb6a5e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072742E5D0>]}
[0m23:32:14.463312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14db6641-00b8-4f75-8749-ad9aeb6a5e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002072794E1B0>]}
[0m23:32:14.463312 [info ] [MainThread]: Found 3 models, 4 data tests, 1 snapshot, 1 source, 432 macros
[0m23:32:14.463312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14db6641-00b8-4f75-8749-ad9aeb6a5e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020726371E80>]}
[0m23:32:14.463312 [info ] [MainThread]: 
[0m23:32:14.463312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:14.463312 [info ] [MainThread]: 
[0m23:32:14.471547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:32:14.473725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Ethio_Medical_Database_analytics'
[0m23:32:14.607000 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:32:14.607000 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: BEGIN
[0m23:32:14.607000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:14.663379 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m23:32:14.663379 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_analytics"
[0m23:32:14.663379 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_analytics"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m23:32:14.679001 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m23:32:14.679001 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: ROLLBACK
[0m23:32:14.679001 [debug] [ThreadPool]: On list_Ethio_Medical_Database_analytics: Close
[0m23:32:14.679001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Ethio_Medical_Database_analytics, now list_Ethio_Medical_Database_public)
[0m23:32:14.679001 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:32:14.679001 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: BEGIN
[0m23:32:14.679001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:14.732371 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:32:14.732371 [debug] [ThreadPool]: Using postgres connection "list_Ethio_Medical_Database_public"
[0m23:32:14.732371 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_Ethio_Medical_Database_public"} */
select
      'Ethio_Medical_Database' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'Ethio_Medical_Database' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:32:14.747998 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m23:32:14.747998 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: ROLLBACK
[0m23:32:14.747998 [debug] [ThreadPool]: On list_Ethio_Medical_Database_public: Close
[0m23:32:14.747998 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:14.747998 [debug] [MainThread]: On master: BEGIN
[0m23:32:14.747998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:32:14.794861 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m23:32:14.794861 [debug] [MainThread]: Using postgres connection "master"
[0m23:32:14.794861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:32:14.810483 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m23:32:14.810483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14db6641-00b8-4f75-8749-ad9aeb6a5e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020726147440>]}
[0m23:32:14.810483 [debug] [MainThread]: On master: ROLLBACK
[0m23:32:14.810483 [debug] [MainThread]: On master: Close
[0m23:32:14.826104 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m23:32:14.826104 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_project.my_first_dbt_model'
[0m23:32:14.826104 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m23:32:14.832611 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m23:32:14.832611 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m23:32:14.832611 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m23:32:14.832611 [debug] [Thread-1 (]: Began running node model.my_project.my_model
[0m23:32:14.832611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_first_dbt_model, now model.my_project.my_model)
[0m23:32:14.832611 [debug] [Thread-1 (]: Began compiling node model.my_project.my_model
[0m23:32:14.848238 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_model"
[0m23:32:14.848238 [debug] [Thread-1 (]: Began executing node model.my_project.my_model
[0m23:32:14.848238 [debug] [Thread-1 (]: Finished running node model.my_project.my_model
[0m23:32:14.848238 [debug] [Thread-1 (]: Began running node snapshot.my_project.medical_data_snapshot
[0m23:32:14.848238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_model, now snapshot.my_project.medical_data_snapshot)
[0m23:32:14.848238 [debug] [Thread-1 (]: Began compiling node snapshot.my_project.medical_data_snapshot
[0m23:32:14.848238 [debug] [Thread-1 (]: Began executing node snapshot.my_project.medical_data_snapshot
[0m23:32:14.848238 [debug] [Thread-1 (]: Finished running node snapshot.my_project.medical_data_snapshot
[0m23:32:14.848238 [debug] [Thread-1 (]: Began running node model.my_project.my_second_dbt_model
[0m23:32:14.848238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.my_project.medical_data_snapshot, now model.my_project.my_second_dbt_model)
[0m23:32:14.848238 [debug] [Thread-1 (]: Began compiling node model.my_project.my_second_dbt_model
[0m23:32:14.863860 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m23:32:14.863860 [debug] [Thread-1 (]: Began executing node model.my_project.my_second_dbt_model
[0m23:32:14.863860 [debug] [Thread-1 (]: Finished running node model.my_project.my_second_dbt_model
[0m23:32:14.863860 [debug] [Thread-1 (]: Began running node test.my_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:32:14.863860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.my_second_dbt_model, now test.my_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m23:32:14.863860 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:32:14.879481 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:32:14.879481 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:32:14.879481 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:32:14.879481 [debug] [Thread-1 (]: Began running node test.my_project.unique_my_first_dbt_model_id.16e066b321
[0m23:32:14.879481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_project.unique_my_first_dbt_model_id.16e066b321)
[0m23:32:14.879481 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_my_first_dbt_model_id.16e066b321
[0m23:32:14.895102 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_my_first_dbt_model_id.16e066b321"
[0m23:32:14.895102 [debug] [Thread-1 (]: Began executing node test.my_project.unique_my_first_dbt_model_id.16e066b321
[0m23:32:14.895102 [debug] [Thread-1 (]: Finished running node test.my_project.unique_my_first_dbt_model_id.16e066b321
[0m23:32:14.895102 [debug] [Thread-1 (]: Began running node test.my_project.not_null_my_second_dbt_model_id.151b76d778
[0m23:32:14.895102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.unique_my_first_dbt_model_id.16e066b321, now test.my_project.not_null_my_second_dbt_model_id.151b76d778)
[0m23:32:14.895102 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_my_second_dbt_model_id.151b76d778
[0m23:32:14.895102 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_my_second_dbt_model_id.151b76d778"
[0m23:32:14.926343 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_my_second_dbt_model_id.151b76d778
[0m23:32:14.926343 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_my_second_dbt_model_id.151b76d778
[0m23:32:14.926343 [debug] [Thread-1 (]: Began running node test.my_project.unique_my_second_dbt_model_id.57a0f8c493
[0m23:32:14.926343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m23:32:14.926343 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_my_second_dbt_model_id.57a0f8c493
[0m23:32:14.932849 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m23:32:14.932849 [debug] [Thread-1 (]: Began executing node test.my_project.unique_my_second_dbt_model_id.57a0f8c493
[0m23:32:14.932849 [debug] [Thread-1 (]: Finished running node test.my_project.unique_my_second_dbt_model_id.57a0f8c493
[0m23:32:14.932849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:14.932849 [debug] [MainThread]: Connection 'list_Ethio_Medical_Database_public' was properly closed.
[0m23:32:14.932849 [debug] [MainThread]: Connection 'test.my_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m23:32:14.932849 [debug] [MainThread]: Command end result
[0m23:32:15.048715 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:32:15.065048 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:32:15.080329 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\run_results.json
[0m23:32:18.803120 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m23:32:18.804110 [info ] [MainThread]: Building catalog
[0m23:32:18.806802 [debug] [ThreadPool]: Acquiring new postgres connection 'Ethio_Medical_Database.information_schema'
[0m23:32:18.826030 [debug] [ThreadPool]: Using postgres connection "Ethio_Medical_Database.information_schema"
[0m23:32:18.826030 [debug] [ThreadPool]: On Ethio_Medical_Database.information_schema: BEGIN
[0m23:32:18.827029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:18.884669 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m23:32:18.885694 [debug] [ThreadPool]: Using postgres connection "Ethio_Medical_Database.information_schema"
[0m23:32:18.885694 [debug] [ThreadPool]: On Ethio_Medical_Database.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "my_project", "target_name": "dev", "connection_name": "Ethio_Medical_Database.information_schema"} */

    
    

    select
        'Ethio_Medical_Database' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('analytics') and
           upper(tbl.relname) = upper('medical_data_snapshot')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('medical_database')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m23:32:18.922999 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.038 seconds
[0m23:32:18.922999 [debug] [ThreadPool]: On Ethio_Medical_Database.information_schema: ROLLBACK
[0m23:32:18.922999 [debug] [ThreadPool]: On Ethio_Medical_Database.information_schema: Close
[0m23:32:18.942649 [debug] [MainThread]: Wrote artifact CatalogArtifact to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\catalog.json
[0m23:32:18.958303 [debug] [MainThread]: Wrote artifact WritableManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\manifest.json
[0m23:32:18.973923 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\semantic_manifest.json
[0m23:32:18.973923 [info ] [MainThread]: Catalog written to E:\DS+ML\AIM3\Week-7\Week-7.Ethiopian-medical-business-Data-Warehouse\my_project\target\catalog.json
[0m23:32:18.973923 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:32:18.973923 after 5.96 seconds
[0m23:32:18.973923 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:32:18.973923 [debug] [MainThread]: Connection 'Ethio_Medical_Database.information_schema' was properly closed.
[0m23:32:18.973923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207260DE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020725C6E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207259B8FB0>]}
[0m23:32:18.973923 [debug] [MainThread]: Flushing usage events
[0m23:32:19.921504 [debug] [MainThread]: An error was encountered while trying to flush usage events
